/*! For license information please see lastingStack.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.lastingStack=e():t.lastingStack=e()}(self,(function(){return t={808:(t,e,n)=>{var r,o,i;void 0===(o="function"==typeof(r=i=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var c="";for(var a in i)i[a]&&(c+="; "+a,!0!==i[a]&&(c+="="+i[a].split(";")[0]));return document.cookie=e+"="+n+c}}function s(t,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var c=i[s].split("="),a=c.slice(1).join("=");n||'"'!==a.charAt(0)||(a=a.slice(1,-1));try{var u=e(c[0]);if(a=(r.read||r)(a,u)||e(a),n)try{a=JSON.parse(a)}catch(t){}if(o[u]=a,t===u)break}catch(t){}}return t?o[t]:o}}return o.set=i,o.get=function(t){return s(t,!1)},o.getJSON=function(t){return s(t,!0)},o.remove=function(e,n){i(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))})?r.call(e,n,e,t):r)||(t.exports=o),t.exports=i()},748:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(910),o=function(){function t(t){var e=t.name,n=void 0===e?r.generateUUID():e,o=t.encode,i=t.decode;this.encode=o,this.decode=i,this.name=n,this.length=n+"__length",this.keys=[]}return t.prototype.cogradient=function(t){this.keys=[];for(var e=0;e<t;e++)this.keys.push(this.getKey(e))},t.prototype.getKey=function(t){return this.name+"__"+t},t.prototype.getLength=function(){return this.keys.length},t}();e.default=o},829:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.AyncStorageStack=e.StorageStack=void 0;var c=n(748),a=function(t){function e(e){var n=this,r=e.name,o=e.encode,i=e.decode,s=e.Storage;return(n=t.call(this,{name:r,encode:o,decode:i})||this).Storage=s,n.init(),n}return o(e,t),e.prototype.init=function(){var t=this.Storage.getItem(this.length);t?this.cogradient(Number(t)):this.Storage.setItem(this.length,"0")},e.prototype.setLength=function(t){this.Storage.setItem(this.length,t),this.cogradient(t)},e.prototype.getData=function(){var t=this.Storage.getItem(this.keys[this.keys.length-1]);return this.decode?this.decode(t):t},e.prototype.push=function(t){var e=this.getLength();return this.Storage.setItem(this.getKey(e),this.encode(t)),this.setLength(e+1),t},e.prototype.pop=function(){var t=this.getLength(),e=this.get(t-1);return this.setLength(t-1),this.Storage.removeItem(this.getKey(t-1)),e},e.prototype.get=function(t){var e=this.getKey(t),n=this.Storage.getItem(e);return this.decode?this.decode(n):n},e.prototype.clear=function(){var t=this;this.setLength(0),this.keys.forEach((function(e){return t.Storage.removeItem(e)})),this.keys=[]},e}(c.default);e.StorageStack=a;var u=function(t){function e(e){var n=this,r=e.name,o=e.encode,i=e.decode,s=e.Storage;return(n=t.call(this,{name:r,encode:o,decode:i})||this).Storage=s,n.loadCbs=[],n.init(),n}return o(e,t),e.prototype.init=function(){return i(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.Storage.getItem(this.length)];case 1:for((t=e.sent())?this.cogradient(Number(t)):this.Storage.setItem(this.length,"0");this.loadCbs.length;)this.loadCbs.pop()();return[2]}}))}))},e.prototype.setLength=function(t){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.Storage.setItem(this.length,t)];case 1:return e.sent(),this.cogradient(t),[2]}}))}))},e.prototype.load=function(t){this.loadCbs.push(t)},e.prototype.getData=function(){return i(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.Storage.getItem(this.keys[this.keys.length-1])];case 1:return t=e.sent(),[2,this.decode?this.decode(t):t]}}))}))},e.prototype.push=function(t){return i(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=this.getLength(),[4,this.Storage.setItem(this.getKey(e),this.encode(t))];case 1:return n.sent(),[4,this.setLength(e+1)];case 2:return n.sent(),[2,t]}}))}))},e.prototype.pop=function(){return i(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return t=this.getLength(),[4,this.get(t-1)];case 1:return e=n.sent(),[4,this.setLength(t-1)];case 2:return n.sent(),[4,this.Storage.removeItem(this.getKey(t-1))];case 3:return n.sent(),[2,e]}}))}))},e.prototype.get=function(t){return i(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return e=this.getKey(t),[4,this.Storage.getItem(e)];case 1:return n=r.sent(),[2,this.decode?this.decode(n):n]}}))}))},e.prototype.clear=function(){return i(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){switch(e.label){case 0:return[4,this.setLength(0)];case 1:return e.sent(),[4,Promise.all(this.keys.map((function(e){return t.Storage.removeItem(e)})))];case 2:return e.sent(),this.keys=[],[2]}}))}))},e}(c.default);e.AyncStorageStack=u},595:(t,e,n)=>{t.exports=n(607).default,t.exports.default=n(607).default},607:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(149),i=n(809),s=n(829),c="session",a={cookie:o.default,local:localStorage,session:sessionStorage,object:i.default},u=function(t){return~Object.keys(a).indexOf(t)};function h(t,e){return e?new s.AyncStorageStack(r({Storage:a[c]},t)):new s.StorageStack(r({Storage:a[c]},t))}e.default=h,h.setMode=function(t){if(!u(t))throw"没有"+t+"模式";c=t},h.installMode=function(t,e){if(u(t))throw"已存在"+t+"模式，无法附加";a[t]=e}},149:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(808);e.default={removeItem:function(t){r.remove(t)},setItem:function(t,e){r.set(t,e)},getItem:function(t){return r.get(t)}}},809:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};e.default={removeItem:function(t){delete n[t]},setItem:function(t,e){n[t]=e},getItem:function(t){return n[t]}}},910:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.generateUUID=void 0,e.generateUUID=function(){var t=Date.now();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}))}}},e={},function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}(595);var t,e}));